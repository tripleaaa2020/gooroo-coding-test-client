{"ast":null,"code":"import React,{useState,useEffect}from'react';import jwt from'jsonwebtoken';import{useSelector,useDispatch}from'react-redux';import{SET_LIBRARY_BOOKS}from'../../store/actions/LibraryActions';import{SET_MY_BOOKS}from'../../store/actions/MyBooksActions';import{getAllBooks}from'../../services/Books';import Book from'../components/book/BookComponent';import'./ListSection.scss';var ListSection=function ListSection(props){console.log(\"ListSection props => \",props);var authToken=localStorage.getItem(\"authToken\");var userPayload=jwt.decode(authToken);var booksListReducer=useSelector(function(state){return props.from===\"Library\"?state.lib:state.mybook;});var books=booksListReducer.books,activeCategories=booksListReducer.activeCategories,searchValue=booksListReducer.searchValue;var dispatch=useDispatch();console.log(\"books => \",books);var setBooks=function setBooks(books){var type=props.from===\"Library\"?SET_LIBRARY_BOOKS:SET_MY_BOOKS;dispatch({type:type,books:books});};useEffect(function(){getAllBooks(userPayload.contributorID,activeCategories,searchValue,props.from).then(function(response){if(response.data){if(response.data.rows)setBooks(response.data.rows);localStorage.setItem('authToken',response.data.authToken);}else{if(response.msg.name===\"TokenExpiredError\"){localStorage.removeItem('authToken');props.history.push('/auth/login');}}});},[dispatch,activeCategories,searchValue,props.location.state]);return React.createElement(\"div\",{style:{backgroundColor:'transparent'},className:\"pt-3 mt-3 px-3 rounded\"},React.createElement(\"div\",{className:\"row books-list\"},books.map(function(book,i){return React.createElement(\"div\",{className:\"col-6 col-lg-3\",key:book.bookID},React.createElement(\"a\",{href:\"#\"},React.createElement(Book,Object.assign({},props,{isAddBook:false,bookID:book.bookID,title:book.title,author:book.author,publisher:book.publisher,categoryID:book.categoryID,contributorID:book.contributorID,contributorName:book.contributors.contributorName}))));}),props.from===\"MyBooks\"&&React.createElement(\"div\",{className:\"col-6 col-lg-3\"},React.createElement(\"a\",{href:\"/my-books/add\"},React.createElement(Book,Object.assign({},props,{isAddBook:true}))))));};export default ListSection;","map":{"version":3,"sources":["/Users/mac/react/gooroo-coding-test-client/src/display/sections/ListSection.js"],"names":["React","useState","useEffect","jwt","useSelector","useDispatch","SET_LIBRARY_BOOKS","SET_MY_BOOKS","getAllBooks","Book","ListSection","props","console","log","authToken","localStorage","getItem","userPayload","decode","booksListReducer","state","from","lib","mybook","books","activeCategories","searchValue","dispatch","setBooks","type","contributorID","then","response","data","rows","setItem","msg","name","removeItem","history","push","location","backgroundColor","map","book","i","bookID","title","author","publisher","categoryID","contributors","contributorName"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport jwt from 'jsonwebtoken';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { SET_LIBRARY_BOOKS } from '../../store/actions/LibraryActions';\nimport { SET_MY_BOOKS } from '../../store/actions/MyBooksActions';\nimport { getAllBooks } from '../../services/Books';\n\nimport Book from '../components/book/BookComponent';\nimport './ListSection.scss';\n\nconst ListSection = props => {\n\n    console.log(\"ListSection props => \", props);\n\n    const authToken = localStorage.getItem(\"authToken\");\n    const userPayload = jwt.decode(authToken);\n\n    const booksListReducer = useSelector(state => (props.from === \"Library\") ? state.lib : state.mybook);\n    const { books, activeCategories, searchValue } = booksListReducer;\n    const dispatch = useDispatch();\n\n    console.log(\"books => \", books);\n\n    const setBooks = (books) => {\n        let type = props.from === \"Library\" ? SET_LIBRARY_BOOKS : SET_MY_BOOKS;\n        dispatch({ type, books })\n    }\n\n    useEffect(() => {\n        getAllBooks(userPayload.contributorID, activeCategories, searchValue, props.from)\n            .then(response => {\n                if (response.data) {\n                    if (response.data.rows)\n                        setBooks(response.data.rows)\n                    localStorage.setItem('authToken', response.data.authToken);\n                }\n                else {\n                    if (response.msg.name === \"TokenExpiredError\") {\n                        localStorage.removeItem('authToken')\n                        props.history.push('/auth/login')\n                    }\n                }\n            });\n    }, [dispatch, activeCategories, searchValue, props.location.state])\n\n    return (\n        <div style={{ backgroundColor: 'transparent' }} className=\"pt-3 mt-3 px-3 rounded\">\n            <div className=\"row books-list\">\n                {books.map((book, i) => {\n                    return (\n                        <div className={\"col-6 col-lg-3\"} key={book.bookID}>\n                            <a href={\"#\"}>\n                                <Book\n                                    {...props}\n                                    isAddBook={false}\n                                    bookID={book.bookID}\n                                    title={book.title}\n                                    author={book.author}\n                                    publisher={book.publisher}\n                                    categoryID={book.categoryID}\n                                    contributorID={book.contributorID}\n                                    contributorName={book.contributors.contributorName}\n                                />\n                            </a>\n                        </div>\n                    );\n                })}\n                {props.from === \"MyBooks\" &&\n                    <div className={\"col-6 col-lg-3\"}>\n                        <a href={\"/my-books/add\"}>\n                            <Book {...props} isAddBook={true} />\n                        </a>\n                    </div>\n                }\n            </div>\n        </div>\n    )\n}\nexport default ListSection"]},"metadata":{},"sourceType":"module"}